id: redis-pass-brute
info:
  name: redis password bruteforce
  author: tarunKoyalwar
  severity: high
  metadata:
    shodan-query: product:"redis"


javascript:
  - pre-condition: |
      isPortOpen(Host,Port)

    code: |
      var m = require("nuclei/redis");
      m.Connect(Host,Port,Password)

    args:
      Host: "{{Host}}"
      Port: "{{getNetworkPort(Port,6379)}}"
      Password: "{{password}}"

    payloads:
      password:
        - root
        - password
        - admin

    matchers-condition: and
    matchers:
      - type: dsl
        dsl:
          - "contains(response,'redis_version')"
          - "contains(error,'no password is set')"
        condition: or