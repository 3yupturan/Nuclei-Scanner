id: test-javascript-ssh
info:
  name: test-javascript-ssh
  author: Ice3man
  severity: high
  metadata:
    shodan-query: "port:5432"

javascript:
  - code: >
      var m = require("nuclei/net");
      var conn = m.Open("tcp", Hostname);
      var resp = m.SendRecv(conn, "INFO\r\n", 0);
      console.log(String.fromCharCode(...resp));
    args:
      Hostname: "{{Hostname}}"
    output: true
    
    matchers:
      - type: word
        part: response
        words:
          - "true"