id: test-javascript-ssh
info:
  name: test-javascript-ssh
  author: Ice3man
  severity: high

javascript:
  - code: >
      var m = require("nuclei/ssh");
      var c = m.Client();

      var response = c.ConnectSSHInfoMode(Host, 22);
     
      if (response) {
          console.log("Banner", response.Banner,Host);
      }
      dump_json(response);
      response;
    args:
      Host: "{{Host}}"
    output: true

    matchers:
      - type: dsl
        dsl:
          - "print_debug(algorithm_selection)"