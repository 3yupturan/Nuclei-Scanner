{
  "$defs": {
    "AttackTypeHolder": {
      "enum": [
        "batteringram",
        "pitchfork",
        "clusterbomb"
      ],
      "markdownDescription": "Attack is the type of payload combinations to perform",
      "title": "attack is the payload combination",
      "type": "string"
    },
    "Classification": {
      "additionalProperties": false,
      "properties": {
        "cpe": {
          "examples": [
            "cpe:/a:vendor:product:version"
          ],
          "markdownDescription": "CPE for the template",
          "title": "cpe for the template",
          "type": "string"
        },
        "cve-id": {
          "$ref": "#/$defs/StringOrSlice",
          "markdownDescription": "CVE IDs for the template",
          "title": "cve ids for the template"
        },
        "cvss-metrics": {
          "examples": [
            "3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H"
          ],
          "markdownDescription": "CVSS Metrics for the template",
          "title": "cvss metrics for the template",
          "type": "string"
        },
        "cvss-score": {
          "examples": [
            9.8
          ],
          "markdownDescription": "CVSS Score for the template",
          "title": "cvss score for the template",
          "type": "number"
        },
        "cwe-id": {
          "$ref": "#/$defs/StringOrSlice",
          "markdownDescription": "CWE IDs for the template",
          "title": "cwe ids for the template"
        },
        "epss-percentile": {
          "examples": [
            0.42509
          ],
          "markdownDescription": "EPSS Percentile for the template",
          "title": "epss percentile for the template",
          "type": "number"
        },
        "epss-score": {
          "examples": [
            0.42509
          ],
          "markdownDescription": "EPSS Score for the template",
          "title": "epss score for the template",
          "type": "number"
        }
      },
      "type": "object"
    },
    "Extractor": {
      "additionalProperties": false,
      "properties": {
        "attribute": {
          "markdownDescription": "Optional attribute to extract from response XPath",
          "title": "optional attribute to extract from xpath",
          "type": "string"
        },
        "case-insensitive": {
          "markdownDescription": "use case insensitive extract",
          "title": "use case insensitive extract",
          "type": "boolean"
        },
        "dsl": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Optional attribute to extract from response dsl",
          "title": "dsl expressions to extract",
          "type": "array"
        },
        "group": {
          "markdownDescription": "Group to extract from regex",
          "title": "group to extract from regex",
          "type": "integer"
        },
        "internal": {
          "markdownDescription": "Internal when set to true will allow using the value extracted in the next request for some protocols",
          "title": "mark extracted value for internal variable use",
          "type": "boolean"
        },
        "json": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "JSON JQ expressions to evaluate from response part",
          "title": "json jq expressions to extract data",
          "type": "array"
        },
        "kval": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Kval pairs to extract from response",
          "title": "kval pairs to extract from response",
          "type": "array"
        },
        "name": {
          "markdownDescription": "Name of the extractor",
          "title": "name of the extractor",
          "type": "string"
        },
        "part": {
          "markdownDescription": "Part of the request response to extract data from",
          "title": "part of response to extract data from",
          "type": "string"
        },
        "regex": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Regex to extract from part",
          "title": "regex to extract from part",
          "type": "array"
        },
        "type": {
          "$ref": "#/$defs/ExtractorTypeHolder"
        },
        "xpath": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "XPath allows using xpath expressions to extract items from html response",
          "title": "html xpath expressions to extract data",
          "type": "array"
        }
      },
      "required": [
        "type"
      ],
      "type": "object"
    },
    "ExtractorTypeHolder": {
      "additionalProperties": false,
      "properties": {
        "ExtractorType": {
          "type": "integer"
        }
      },
      "required": [
        "ExtractorType"
      ],
      "type": "object"
    },
    "HTTPMethodTypeHolder": {
      "enum": [
        "GET",
        "HEAD",
        "POST",
        "PUT",
        "DELETE",
        "CONNECT",
        "OPTIONS",
        "TRACE",
        "PATCH",
        "PURGE",
        "DEBUG"
      ],
      "markdownDescription": "Method is the HTTP Request Method",
      "title": "method is the HTTP request method",
      "type": "string"
    },
    "Holder": {
      "enum": [
        "info",
        "low",
        "medium",
        "high",
        "critical",
        "unknown"
      ],
      "markdownDescription": "Seriousness of the implications of the template",
      "title": "severity of the template",
      "type": "string"
    },
    "Info": {
      "additionalProperties": false,
      "examples": [
        "\n\tname: Example Template\n\tauthor: pdteam\n\tseverity: info\n\tdescription: This is an example template",
        "\n\tname: example-template\n\tauthor: pdteam\n\tseverity: unknown\n\tdescription: Example description of the template\n\timpact: Impact of the template\n\treference: \n\t  - https://example.com\n\tmetadata: \n\t  max-request: 1\n\ttags: http"
      ],
      "properties": {
        "author": {
          "markdownDescription": "Author is the author of the template",
          "oneOf": [
            {
              "description": "Author of the template without any special characters\nIt can be a single author or comma-separated multiple authors",
              "examples": [
                "pdteam"
              ],
              "type": "string"
            },
            {
              "description": "Author of the template without any special characters\nIt can be a single author or comma-separated multiple authors",
              "examples": [
                "pdteam,mr.robot"
              ],
              "type": "array"
            }
          ],
          "title": "author of the template"
        },
        "classification": {
          "$ref": "#/$defs/Classification",
          "examples": [
            "\n\tcvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\n\tcvss-score: 10\n\tcve-id: CVE-2021-44228",
            "\n\tcwe-id: CWE-20,CWE-917"
          ],
          "markdownDescription": "Classification contains classification information about the template.\nThis could be any classification information like CWE, CVE, EPSS etc.\nNote - This is autogenerated and updated regularly for CVE templates merged in projectdiscovery/nuclei-templates repository.\nExample:\n```yaml\ncvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\ncvss-score: 10\ncve-id: CVE-2021-44228\ncwe-id: CWE-20,CWE-917\nepss-score: 0.97453\nepss-percentile: 0.99942\ncpe: cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:*\n```",
          "title": "classification info for the template",
          "type": "object"
        },
        "description": {
          "examples": [
            "Bower is a package manager which stores package information in the bower.json file",
            "Example description of the template"
          ],
          "markdownDescription": "Description of the template.\nYou can go in-depth here on what the template actually does.\nExample:\nApache Log4j2 \u003c=2.14.1 JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints. An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled.",
          "title": "description of the template",
          "type": "string"
        },
        "impact": {
          "examples": [
            "Successful exploitation of this vulnerability could allow an attacker to execute arbitrary SQL queries",
            "Impact of the template"
          ],
          "markdownDescription": "Impact of the template.\nYou can go in-depth here on impact of the template.\nExample:\nSuccessful exploitation of this vulnerability can lead to remote code execution, potentially compromising the affected system.",
          "title": "impact of the template",
          "type": "string"
        },
        "markdownDescription": {
          "markdownDescription": "Classification contains classification information about the template.\nThis could be any classification information like CWE, CVE, EPSS etc.\nNote - This is autogenerated and updated regularly for CVE templates merged in projectdiscovery/nuclei-templates repository.\nExample:\n```yaml\ncvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H\ncvss-score: 10\ncve-id: CVE-2021-44228\ncwe-id: CWE-20,CWE-917\nepss-score: 0.97453\nepss-percentile: 0.99942\ncpe: cpe:2.3:a:apache:log4j:*:*:*:*:*:*:*:*\n```",
          "type": "string"
        },
        "metadata": {
          "examples": [
            "\n\tmax-request: 1",
            "\n\tmax-request: 2\n\tvendor: apache\n\tproduct: log4j2"
          ],
          "markdownDescription": "Optional metadata for the template.\nthis could be any useful metadata like Vendor, Product, Version, etc.\nNote - This is autogenerated and updated regularly for templates merged in projectdiscovery/nuclei-templates repository.\nExample:\n```yaml\nVendor: Apache\nProduct: Log4j2\nVersion: \u003c=2.14.1\n```",
          "title": "additional metadata for the template",
          "type": "object"
        },
        "name": {
          "examples": [
            "Nagios Default Credentials Check",
            "example-template",
            "TeamCity - Authentication Bypass"
          ],
          "markdownDescription": "Name should be good short summary that identifies what the template does",
          "title": "name of the template",
          "type": "string"
        },
        "reference": {
          "$ref": "#/$defs/StringOrSlice",
          "examples": [
            "\n\t- https://example.com"
          ],
          "markdownDescription": "References for the template.\nThis should contain links relevant to the template.\nExample:\nhttps://logging.apache.org/log4j/2.x/security.html\nhttps://nvd.nist.gov/vuln/detail/CVE-2021-44228",
          "title": "references for the template",
          "type": "array"
        },
        "remediation": {
          "examples": [
            "Change the default administrative username and password of Apache ActiveMQ by editing the file jetty-realm.properties"
          ],
          "markdownDescription": "In-depth explanation on how to fix the issues found by the template",
          "title": "remediation steps for the template",
          "type": "string"
        },
        "severity": {
          "$ref": "#/$defs/Holder",
          "examples": [
            "info"
          ],
          "markdownDescription": "Severity of the template.\nsupported values: info, low, medium, high, critical, unknown"
        },
        "tags": {
          "markdownDescription": "Any tags for the template",
          "oneOf": [
            {
              "description": "Tags for the template separated by commas (No spaces)",
              "examples": [
                "cve"
              ],
              "type": "string"
            },
            {
              "description": "Multiple tags for the template separated by commas (No spaces)",
              "examples": [
                "cve,http",
                "http,oast",
                "cve2024,cve"
              ],
              "type": "array"
            }
          ],
          "title": "tags of the template"
        }
      },
      "required": [
        "name",
        "author"
      ],
      "type": "object"
    },
    "Matcher": {
      "additionalProperties": false,
      "properties": {
        "binary": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Binary are the binary patterns required to be present in the response part",
          "title": "binary patterns to match in response",
          "type": "array"
        },
        "case-insensitive": {
          "markdownDescription": "use case insensitive match",
          "title": "use case insensitive match",
          "type": "boolean"
        },
        "condition": {
          "enum": [
            "and",
            "or"
          ],
          "markdownDescription": "Condition between the matcher variables",
          "title": "condition between matcher variables",
          "type": "string"
        },
        "dsl": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "DSL are the dsl expressions that will be evaluated as part of nuclei matching rules",
          "title": "dsl expressions to match in response",
          "type": "array"
        },
        "encoding": {
          "enum": [
            "hex"
          ],
          "markdownDescription": "Optional encoding for the word fields",
          "title": "encoding for word field",
          "type": "string"
        },
        "internal": {
          "markdownDescription": "hide matcher from output",
          "title": "hide matcher from output",
          "type": "boolean"
        },
        "match-all": {
          "markdownDescription": "match all matcher values ignoring condition",
          "title": "match all values",
          "type": "boolean"
        },
        "name": {
          "markdownDescription": "Name of the matcher",
          "title": "name of the matcher",
          "type": "string"
        },
        "negative": {
          "markdownDescription": "Negative specifies if the match should be reversed. It will only match if the condition is not true",
          "title": "negative specifies if match reversed",
          "type": "boolean"
        },
        "part": {
          "markdownDescription": "Part of response to match data from",
          "title": "part of response to match",
          "type": "string"
        },
        "regex": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Regex contains regex patterns required to be present in the response part",
          "title": "regex to match in response",
          "type": "array"
        },
        "size": {
          "items": {
            "type": "integer"
          },
          "markdownDescription": "Size is the acceptable size for the response",
          "title": "acceptable size for response",
          "type": "array"
        },
        "status": {
          "items": {
            "type": "integer"
          },
          "markdownDescription": "Status to match for the response",
          "title": "status to match",
          "type": "array"
        },
        "type": {
          "$ref": "#/$defs/MatcherTypeHolder",
          "markdownDescription": "Type of the matcher",
          "title": "type of matcher"
        },
        "words": {
          "items": {
            "type": "string"
          },
          "markdownDescription": " Words contains word patterns required to be present in the response part",
          "title": "words to match in response",
          "type": "array"
        },
        "xpath": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "xpath are the XPath queries that will be evaluated against the response part of nuclei matching rules",
          "title": "xpath queries to match in response",
          "type": "array"
        }
      },
      "required": [
        "type"
      ],
      "type": "object"
    },
    "MatcherTypeHolder": {
      "additionalProperties": false,
      "properties": {
        "MatcherType": {
          "type": "integer"
        }
      },
      "required": [
        "MatcherType"
      ],
      "type": "object"
    },
    "OrderedMap[string,string]": {
      "additionalProperties": false,
      "properties": {},
      "type": "object"
    },
    "Request": {
      "additionalProperties": false,
      "anyOf": [
        {
          "required": [
            "path"
          ]
        },
        {
          "required": [
            "raw"
          ]
        },
        {
          "required": [
            "filters",
            "payload",
            "fuzzing"
          ]
        },
        {
          "required": [
            "payloads",
            "path"
          ]
        },
        {
          "required": [
            "payloads",
            "raw"
          ]
        }
      ],
      "properties": {
        "attack": {
          "$ref": "#/$defs/AttackTypeHolder",
          "examples": [
            "batteringram",
            "pitchfork",
            "clusterbomb"
          ],
          "markdownDescription": "Attack is the type of payload combinations to perform\nbatteringram the same payload into all defined payload positions at once, pitchfork combines multiple payload sets and clusterbomb generates permutations and combinations for all payloads\nExample: \n```yaml\n- attack: clusterbomb\n```\nNote: this is only applicable when 'payloads' are defined"
        },
        "body": {
          "examples": [
            "key=value\u0026key2=value2"
          ],
          "markdownDescription": "Body contains the HTTP body to be sent with the request\nExample: \n```yaml\n- body: \"key=value\u0026key2=value2\"\n```",
          "title": "body is the http request body",
          "type": "string"
        },
        "cookie-reuse": {
          "deprecated": true,
          "examples": [
            true
          ],
          "markdownDescription": "Deprecated: this is default behaviour now use disable-cookie to explicitly disable cookie reuse",
          "title": "optional cookie reuse enable",
          "type": "boolean"
        },
        "digest-password": {
          "examples": [
            "admin"
          ],
          "markdownDescription": "DigestPassword specifies the password for digest authentication\nExample: \n```yaml\n- digest-password: admin\n```",
          "title": "specifies the password for digest authentication",
          "type": "string"
        },
        "digest-username": {
          "examples": [
            "admin"
          ],
          "markdownDescription": "DigestUsername specifies the username for digest authentication\nExample: \n```yaml\n- digest-username: admin\n```",
          "title": "specifies the username for digest authentication",
          "type": "string"
        },
        "disable-cookie": {
          "examples": [
            true
          ],
          "markdownDescription": "Disable Cookie is an optional setting to disable cookie reuse for this request\nExample: \n```yaml\n- disable-cookie: true\n```",
          "title": "optional disable cookie reuse",
          "type": "boolean"
        },
        "disable-path-automerge": {
          "examples": [
            true
          ],
          "markdownDescription": "DisablePathAutomerge disables the automatic merging of path/query-params from input/target to path defined in template\nExample: \n```yaml\n- disable-path-automerge: true\n```",
          "title": "disable auto merging of path",
          "type": "boolean"
        },
        "extractors": {
          "items": {
            "$ref": "#/$defs/Extractor"
          },
          "markdownDescription": "Extractors contains the extraction mechanism for the request to identify and extract parts of the response",
          "title": "extractors to run on response",
          "type": "array"
        },
        "filter": {
          "items": {
            "$ref": "#/$defs/Matcher"
          },
          "markdownDescription": "Filter is matcher-like field to check if fuzzing should be performed on this request or not",
          "title": "filter for fuzzing",
          "type": "array"
        },
        "filter-condition": {
          "enum": [
            "and",
            "or"
          ],
          "markdownDescription": "Conditions between the filters",
          "title": "condition between the filters",
          "type": "string"
        },
        "fuzzing": {
          "items": {
            "$ref": "#/$defs/Rule"
          },
          "markdownDescription": "Fuzzing or DAST specifies rules for fuzzing requests\nthese rules mutate the input request to generate multiple requests\nFor example, replacing all query param values with sqli payloads",
          "title": "fuzzin rules for http fuzzing",
          "type": "array"
        },
        "headers": {
          "additionalProperties": {
            "type": "string"
          },
          "examples": [
            "User-Agent: Mozilla/5.0",
            "Authorization: Bearer {{token}}",
            "X-Forwarded-For: {{Hostname}}",
            "Origin: {{BaseURL}}",
            "Referer: {{BaseURL}}/admin"
          ],
          "markdownDescription": "Headers contains the HTTP headers to be sent with the request\nExample: \n```yaml\n- headers:\n\tUser-Agent: Mozilla/5.0\n```",
          "title": "headers to send with the http request",
          "type": "object"
        },
        "host-redirects": {
          "examples": [
            true
          ],
          "markdownDescription": "HostRedirects specifies whether only redirects to the same host should be followed by the HTTP Client\nWhen set to true, only redirects to the same host are followed\nExample: \n```yaml\n- host-redirects: true\n```",
          "title": "follow same host http redirects",
          "type": "boolean"
        },
        "id": {
          "examples": [
            "example-http-id"
          ],
          "markdownDescription": "Optional ID of this HTTP Request Block\nThis is useful when calling /executing this request block in flow\nBy default, current index in the http array is used as ID\nExample: \n```yaml\n- id: wp-login\n```",
          "title": "id for the http request",
          "type": "string"
        },
        "iterate-all": {
          "deprecated": true,
          "markdownDescription": "Deprecated: use flow to properly specify iteration logic",
          "title": "iterate all the values",
          "type": "boolean"
        },
        "markdownDescription": {
          "markdownDescription": "Signature is the HTTP Request signature Method",
          "type": "string"
        },
        "matchers": {
          "items": {
            "$ref": "#/$defs/Matcher"
          },
          "markdownDescription": "Detection mechanism to identify whether the request was successful by doing pattern matching",
          "title": "matchers to run on response",
          "type": "array"
        },
        "matchers-condition": {
          "enum": [
            "and",
            "or"
          ],
          "markdownDescription": "Conditions between the matchers",
          "title": "condition between the matchers",
          "type": "string"
        },
        "max-redirects": {
          "examples": [
            10
          ],
          "markdownDescription": "MaxRedirects is the maximum number of redirects to follow\nExample: \n```yaml\n- max-redirects: 10\n```",
          "title": "maximum number of redirects to follow",
          "type": "integer"
        },
        "max-size": {
          "examples": [
            1024
          ],
          "markdownDescription": "MaxSize is the maximum size of the response body to be read\nExample: \n```yaml\n- max-size: 1024\n```",
          "title": "maximum http response body size",
          "type": "integer"
        },
        "method": {
          "$ref": "#/$defs/HTTPMethodTypeHolder",
          "examples": [
            "GET",
            "HEAD",
            "POST",
            "PUT",
            "DELETE",
            "CONNECT",
            "OPTIONS",
            "TRACE",
            "PATCH",
            "PURGE",
            "DEBUG"
          ],
          "markdownDescription": "Method is the HTTP method to be used for the request\nExample: \n```yaml\n- method: GET\n```"
        },
        "name": {
          "examples": [
            "example-http-name"
          ],
          "markdownDescription": "Name is the optional name of the request\nIf a name is specified, all the named request in a template can be matched upon\nin a combined manner allowing multi-request based matchers.",
          "title": "name for the http request",
          "type": "string"
        },
        "path": {
          "examples": [
            "\n\t- '{{BaseURL}}'",
            "\n\t- '{{RootURL}}'",
            "\n\t- '{{Hostname}}:8080/ca-cert'"
          ],
          "items": {
            "type": "string"
          },
          "markdownDescription": "Path contains HTTP URL[s] to be sent. Here only Path portion is generally specified and host is templatetized\nExample: \n```yaml\n- path:\n\t{{BaseURL}}/admin\n```",
          "title": "path(s) for the http request",
          "type": "array"
        },
        "payloads": {
          "examples": [
            "  # inline payloads\n\tusername:\n\t\t- admin\n\t\t- root\n\tpassword:\n\t\t- password\n\t\t- admin\n\n",
            "  # file payloads\n\tusername: /path/to/usernames.txt\n\tpassword: /path/to/passwords.txt\n\n"
          ],
          "markdownDescription": "Payloads contains key-value pairs of payloads to be used\nThese payloads when referenced in http request will be iterated appropriately and replaced\nOptionally payload also support loading values from file instead of defining them inline\nExample: \n```yaml\n- payloads:\n\tusername:\n\t\t- admin\n\t\t- root\n\tpassword:\n\t\t- password\n\t\t- admin\n```",
          "title": "payloads for the http request",
          "type": "object"
        },
        "pipeline": {
          "examples": [
            true
          ],
          "markdownDescription": "Pipeline defines if the attack should be performed with HTTP 1.1 Pipelining\nAll requests must be idempotent (GET/POST). This can be used for race conditions/billions requests.\nExample: \n```yaml\n- pipeline: true\n```",
          "title": "perform HTTP 1.1 pipelining",
          "type": "boolean"
        },
        "pipeline-concurrent-connections": {
          "examples": [
            10
          ],
          "markdownDescription": "PipelineConcurrentConnections specifies the number of concurrent connections to be used for pipelining\nExample: \n```yaml\n- pipeline-concurrent-connections: 10\n  pipeline: true\n```",
          "title": "number of pipelining connections",
          "type": "integer"
        },
        "pipeline-requests-per-connection": {
          "examples": [
            10
          ],
          "markdownDescription": "PipelineRequestsPerConnection specifies the number of requests to be sent per connection\nExample: \n```yaml\n- pipeline: true\n  pipeline-requests-per-connection: 10\n```",
          "title": "number of requests to send per pipelining connections",
          "type": "integer"
        },
        "race": {
          "examples": [
            true
          ],
          "markdownDescription": "Race determines if all the request have to be attempted at the same time (Race Condition)\nThe actual number of requests that will be sent is determined by the `race_count`  field.\nExample: \n```yaml\n- race: true\n  race_count: 100\n```",
          "title": "perform race-http request coordination attack",
          "type": "boolean"
        },
        "race_count": {
          "examples": [
            100
          ],
          "markdownDescription": "RaceCount specifies the number of requests to be sent when attempting race condition attacks\nExample: \n```yaml\n- race: true\n  race_count: 100\n```",
          "title": "number of times to repeat request in race condition",
          "type": "integer"
        },
        "raw": {
          "examples": [
            "\n# raw-get-request\n\t- |\n\t\tGET / HTTP/1.1\n\t\tHost: {{Hostname}}\n\n",
            "\n# raw-post-request\n\t- |\n\t\tPOST / HTTP/1.1\n\t\tHost: {{Hostname}}\n\t\tContent-Type: application/json\n\t\tContent-Length: 13\n\n\n\t\t{\"key\": \"value\"}\n\n"
          ],
          "items": {
            "type": "string"
          },
          "markdownDescription": "Raw contains HTTP Request[s] in raw or request dump format\nExample: \n- raw:\n\t- |\n\t\tGET / HTTP/1.1\n\t\tHost: {{Hostname}}\n\n\n\nNote: If input contains any path/query-params they are automerged unless explicitly disabled using 'disable-path-automerge'",
          "type": "array"
        },
        "read-all": {
          "examples": [
            true
          ],
          "markdownDescription": "Enables force reading of the entire raw unsafe request body ignoring  any specified content length headers\nExample: \n```yaml\n- read-all: true\n```",
          "title": "force read all body",
          "type": "boolean"
        },
        "redirects": {
          "examples": [
            true
          ],
          "markdownDescription": "Redirects specifies whether to follow redirects or not\nThis can be use in conjunction with max-redirects to effectively control the redirects\nExample: \n```yaml\n- redirects: true\n```",
          "title": "follow http redirects",
          "type": "boolean"
        },
        "req-condition": {
          "deprecated": true,
          "markdownDescription": "Deprecated: this is automatically identified and used (https://github.com/projectdiscovery/nuclei/issues/2393)",
          "title": "preserve request history",
          "type": "boolean"
        },
        "self-contained": {
          "examples": [
            true
          ],
          "markdownDescription": "SelfContained specifies whether the request is self-contained or not\nThis means if the request is dependent on input or is self-contained\nExample: \n```yaml\n- self-contained: true\n```",
          "type": "boolean"
        },
        "signature": {
          "$ref": "#/$defs/SignatureTypeHolder",
          "deprecated": true,
          "markdownDescription": "Signature is the HTTP Request signature Method",
          "title": "signature is the http request signature method"
        },
        "skip-variables-check": {
          "examples": [
            true
          ],
          "markdownDescription": "SkipVariablesCheck skips the check for unresolved variables in request\nThis is also useful in case where body contains payload in format of {{xyz}}\nExample: \n```yaml\n- skip-variables-check: true\n```",
          "title": "skip variable checks",
          "type": "boolean"
        },
        "stop-at-first-match": {
          "markdownDescription": "StopAtFirstMatch specifies whether to stop at first match or not\nThis is useful for cases like brute-forcing where we want to stop once we find the first correct login credential\nExample: \n```yaml\n- stop-at-first-match: true\n```",
          "title": "stop at first match",
          "type": "boolean"
        },
        "threads": {
          "examples": [
            10
          ],
          "markdownDescription": "Threads specifies concurreny with which requests should be sent\nIt should not be specified unless explicitly behaviour and its value is obtained from -pc (-payload-concurrency) flag\nExample: \n```yaml\n- threads: 10\n```",
          "title": "threads for sending requests",
          "type": "integer"
        },
        "unsafe": {
          "examples": [
            true
          ],
          "markdownDescription": "Unsafe specifies whether to use rawhttp engine for sending Non RFC-Compliant requests.\nThis uses the [rawhttp](https://github.com/projectdiscovery/rawhttp) engine to achieve complete\ncontrol over the request, with no normalization performed by the client.\nExample: \n```yaml\n- unsafe: true\n```",
          "title": "use rawhttp non-strict-rfc client",
          "type": "boolean"
        }
      },
      "type": "object"
    },
    "Rule": {
      "additionalProperties": false,
      "properties": {
        "fuzz": {
          "$ref": "#/$defs/SliceOrMapSlice",
          "markdownDescription": "Payloads to perform fuzzing substitutions with",
          "title": "payloads of fuzz rule"
        },
        "keys": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Keys of parameters to fuzz",
          "title": "keys of parameters to fuzz",
          "type": "array"
        },
        "keys-regex": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Regex of parameter keys to fuzz",
          "title": "keys regex to fuzz",
          "type": "array"
        },
        "mode": {
          "enum": [
            "single",
            "multiple"
          ],
          "markdownDescription": "Mode of request rule to fuzz",
          "title": "mode of rule",
          "type": "string"
        },
        "part": {
          "enum": [
            "query",
            "header",
            "path",
            "body",
            "cookie",
            "request"
          ],
          "markdownDescription": "Part of request rule to fuzz",
          "title": "part of rule",
          "type": "string"
        },
        "replace-regex": {
          "markdownDescription": "Regex for regex-replace rule type",
          "title": "replace regex of rule",
          "type": "string"
        },
        "type": {
          "enum": [
            "replace",
            "prefix",
            "postfix",
            "infix",
            "replace-regex"
          ],
          "markdownDescription": "Type of fuzzing rule to perform",
          "title": "type of rule",
          "type": "string"
        },
        "values": {
          "items": {
            "type": "string"
          },
          "markdownDescription": "Regex of parameter values to fuzz",
          "title": "values regex to fuzz",
          "type": "array"
        }
      },
      "type": "object"
    },
    "SignatureTypeHolder": {
      "enum": [
        "AWS"
      ],
      "markdownDescription": "Type of the signature",
      "title": "type of the signature",
      "type": "string"
    },
    "SliceOrMapSlice": {
      "additionalProperties": false,
      "properties": {
        "KV": {
          "$ref": "#/$defs/OrderedMap[string,string]"
        },
        "Value": {
          "items": {
            "type": "string"
          },
          "type": "array"
        }
      },
      "required": [
        "Value",
        "KV"
      ],
      "type": "object"
    },
    "StringOrSlice": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "type": "array"
        }
      ]
    },
    "Template": {
      "additionalProperties": false,
      "anyOf": [
        {
          "required": [
            "id",
            "info",
            "http"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "dns"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "file"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "tcp"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "headless"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "ssl"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "websocket"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "whois"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "code"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "javascript"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "requests"
          ]
        },
        {
          "required": [
            "id",
            "info",
            "network"
          ]
        },
        {
          "required": [
            "workflows"
          ]
        }
      ],
      "properties": {
        "code": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Code snippets",
          "title": "code snippets to make",
          "type": "array"
        },
        "constants": {
          "examples": [
            "\n\texploit: 'x0x0x0x0x0x0x'"
          ],
          "markdownDescription": "Constants are the global constants that once defined here can be used anywhere in the template\nIt can be used in same way as variables but only difference is that constants cannot be overridden by -V flag at runtime\nExample: \n```yaml\nconstants:\n  exploit: 'x0x0x0x0x0x0x'\n```",
          "title": "constant for the template",
          "type": "object"
        },
        "dns": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "DNS requests to make for the template",
          "title": "dns requests to make",
          "type": "array"
        },
        "file": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "File requests to make for the template",
          "title": "file requests to make",
          "type": "array"
        },
        "flow": {
          "examples": [
            "http(1) \u0026\u0026 http(2)",
            " | # example-vhost-enum\n\tssl(); // -\u003e  execute all ssl protocol requests\n\tdns(); // -\u003e  execute all dns protocol requests\n\tfor (let got of template.domains) { // -\u003e  iterate over 'domains' array variable\n\t\tset('vhost', got); // -\u003e  set 'vhost' variable to current domain\n\t\thttp(); // -\u003e  execute all http protocol requests\n\t}\n"
          ],
          "markdownDescription": "Flow describes how multiple request-blocks/protocols should be combined together and executed\nIt is a javascript code where each protocol is a function and all request-blocks are indexed by their corresponding index in request array\nExample: \n flow: http(1) \u0026\u0026 http(2)\n means that second http request will be executed only if first http request is successful (aka matched)",
          "title": "template execution flow in js",
          "type": "string"
        },
        "headless": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Headless requests to make for the template",
          "title": "headless requests to make",
          "type": "array"
        },
        "http": {
          "examples": [
            " # http get\n\t- method: GET\n\t\tpath:\n\t\t\t- \"{{BaseURL}}\"\n\t\t\n\t\tmatchers:\n\t\t\t- type: status\n\t\t\t\tstatus:\n\t\t\t\t\t- 200",
            " # raw get\n\t- raw:\n\t\t\t- |\n\t\t\t\t\tGET HTTP/1.1\n\t\t\t\t\tHost: {{Hostname}}\n\t\t\t\t\n\t\t\tmatchers:\n\t\t\t- type: status\n\t\t\t\tstatus:\n\t\t\t\t\t- 200",
            " # http self contained\n\t- method: GET\n\t\tpath:\n\t\t  - \"https://api.stripe.com/v1/charges\"\n\t\t\n\t\tself-contained: true\n\t\theaders:\n\t\t\tAuthorization: 'Basic {{base64(token)}}'\n\t\t\n\t\tmatchers:\n\t\t  - type: word\n\t\t    part: body\n\t\t    words:\n\t\t      - '\"object\":'\n\t\t      - '\"url\":'\n\t\t      - '\"data\":'\n\t\t    condition: and"
          ],
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "HTTP is the protocol block for sending HTTP requests\nIt is of array type and can contain multiple requests\nExample: \n```yaml\nhttp: \n\t- method: GET\n\t\tpath:\n\t\t\t- \"{{BaseURL}}\"\n\t\t\n\t\tmatchers:\n\t\t\t- type: status\n\t\t\tstatus:\n\t\t\t\t- 200\n```",
          "title": "http requests to make",
          "type": "array"
        },
        "id": {
          "examples": [
            "example-id",
            "git-config-exposure",
            "azure-apps-nxdomain-takeover",
            "cve-2021-19520"
          ],
          "markdownDescription": "ID is the unique id for the template.\n ### Good IDs \nA good ID uniquely identifies what the requests in the template\nare doing. Let's say you have a template that identifies a git-config\nfile on the webservers, a good name would be `git-config-exposure`. Another\nexample name is `azure-apps-nxdomain-takeover`",
          "pattern": "^([a-zA-Z0-9]+[-_])*[a-zA-Z0-9]+$",
          "title": "id of the template",
          "type": "string"
        },
        "info": {
          "$ref": "#/$defs/Info",
          "markdownDescription": "Info contains the required metadata information about the template\nIt is meant to provide basic but necessary info like name, author , severity\nalong with many other optional fields like metadata, classification etc\nExample: \n```yaml\ninfo: \n\tname: Example Template\n\tauthor: pdteam\n\tseverity: info\n\tdescription: This is an example template\n```\n\nNote: - \nFor a template to be valid name,author,severity of `info` section must be set",
          "title": "info for the template",
          "type": "object"
        },
        "javascript": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Javascript requests to make for the template",
          "title": "javascript requests to make",
          "type": "array"
        },
        "markdownDescription": {
          "markdownDescription": "HTTP is the protocol block for sending HTTP requests\nIt is of array type and can contain multiple requests\nExample: \n```yaml\nhttp: \n\t- method: GET\n\t\tpath:\n\t\t\t- \"{{BaseURL}}\"\n\t\t\n\t\tmatchers:\n\t\t\t- type: status\n\t\t\tstatus:\n\t\t\t\t- 200\n```",
          "type": "string"
        },
        "network": {
          "deprecated": true,
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Network requests to make for the template",
          "title": "network requests to make",
          "type": "array"
        },
        "requests": {
          "deprecated": true,
          "examples": [
            " # http get\n\t- method: GET\n\t\tpath:\n\t\t\t- \"{{BaseURL}}\"\n\t\t\n\t\tmatchers:\n\t\t\t- type: status\n\t\t\t\tstatus:\n\t\t\t\t\t- 200",
            " # raw get\n\t- raw:\n\t\t\t- |\n\t\t\t\t\tGET HTTP/1.1\n\t\t\t\t\tHost: {{Hostname}}\n\t\t\t\t\n\t\t\tmatchers:\n\t\t\t- type: status\n\t\t\t\tstatus:\n\t\t\t\t\t- 200",
            " # http self contained\n\t- method: GET\n\t\tpath:\n\t\t  - \"https://api.stripe.com/v1/charges\"\n\t\t\n\t\tself-contained: true\n\t\theaders:\n\t\t\tAuthorization: 'Basic {{base64(token)}}'\n\t\t\n\t\tmatchers:\n\t\t  - type: word\n\t\t    part: body\n\t\t    words:\n\t\t      - '\"object\":'\n\t\t      - '\"url\":'\n\t\t      - '\"data\":'\n\t\t    condition: and"
          ],
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "HTTP is the protocol block for sending HTTP requests\nIt is of array type and can contain multiple requests\nExample: \n```yaml\nrequests: \n\t- method: GET\n\t\tpath:\n\t\t\t- \"{{BaseURL}}\"\n\t\t\n\t\tmatchers:\n\t\t\t- type: status\n\t\t\tstatus:\n\t\t\t\t- 200\n```",
          "title": "http requests to make",
          "type": "array"
        },
        "self-contained": {
          "default": false,
          "examples": [
            true
          ],
          "markdownDescription": "Self-contained marks all requests in this template as independent of input which means input/target is not required for execution of template\nbut other variables defined in template need to be explicitly set using -V flag\nDefault value is false\nNote: self-contained templates only run once regardless of how many targets where provided to nuclei\nExample: \n```yaml\nself-contained: true\n```\nFull example template of self-contained is available at https://cloud.projectdiscovery.io/public/aws-app-enum",
          "title": "mark requests as self-contained",
          "type": "boolean"
        },
        "signature": {
          "deprecated": true,
          "examples": [
            "aws"
          ],
          "markdownDescription": "Signature is the HTTP Request signature Method",
          "title": "signature is the http request signature method",
          "type": "string"
        },
        "ssl": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "SSL requests to make for the template",
          "title": "ssl requests to make",
          "type": "array"
        },
        "stop-at-first-match": {
          "default": false,
          "examples": [
            true
          ],
          "markdownDescription": "stop-at-first-match stops the execution of template as soon as first match/result was found in a template given that template was sending multiple requests\nthis is required in case of default-login , brute-force and even detection templates where multiple requests are sent from template but we want to exit as soon as first match/result was found\nExample: \n```yaml\nstop-at-first-match: true\n```\nFull example template of stop-at-first-match is available at https://cloud.projectdiscovery.io/public/bitbucket-public-repository",
          "title": "stop at first match",
          "type": "boolean"
        },
        "tcp": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Network requests to make for the template",
          "title": "network(tcp) requests to make",
          "type": "array"
        },
        "variables": {
          "examples": [
            "\n\tdomain: \"{{FQDN}}\"\n\temail: pdteam@{{domain}}",
            "\n\toast: \"{{interact-sh}}\"\n\tpayload: \"{{base64(oast)}}\""
          ],
          "markdownDescription": "Variables are the global variables that once defined here can be used anywhere in the template\nVariables are evaluated in the order they are defined so one variable can be referenced in another variable\nVariables are evaluated before sending every requests so one can reference any variables that are available at runtime and they will be evaluate and used when referenced\nExample: \n```yaml\nvariables:\n  oast: {{interact-sh}}\n  payload: \"{{base64(oast)}}\"\n```\nFull example template of variables is available at https://cloud.projectdiscovery.io/public/screenshot\nNote: -\nThese variables can be overridden by -V flag at runtime if needed",
          "title": "variables for the http request",
          "type": "object"
        },
        "websocket": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "Websocket requests to make for the template",
          "title": "websocket requests to make",
          "type": "array"
        },
        "whois": {
          "items": {
            "$ref": "#/$defs/Request"
          },
          "markdownDescription": "WHOIS requests to make for the template",
          "title": "whois requests to make",
          "type": "array"
        },
        "workflows": {
          "items": {
            "$ref": "#/$defs/WorkflowTemplate"
          },
          "markdownDescription": "List of workflows to execute for template",
          "title": "list of workflows to execute",
          "type": "array"
        }
      },
      "required": [
        "id",
        "info"
      ],
      "type": "object"
    },
    "Variable": {
      "additionalProperties": false,
      "properties": {},
      "type": "object"
    },
    "WorkflowTemplate": {
      "additionalProperties": false,
      "properties": {
        "matchers": {
          "items": {
            "$ref": "#/$defs/Matcher"
          },
          "markdownDescription": "Matchers perform name based matching to run subtemplates for a workflow",
          "title": "name based template result matchers",
          "type": "array"
        },
        "subtemplates": {
          "items": {
            "$ref": "#/$defs/WorkflowTemplate"
          },
          "markdownDescription": "Subtemplates are ran if the template field Template matches",
          "title": "subtemplate based result matchers",
          "type": "array"
        },
        "tags": {
          "$ref": "#/$defs/StringOrSlice",
          "markdownDescription": "Tags to run template based on",
          "title": "tags to execute"
        },
        "template": {
          "markdownDescription": "Template or directory to execute as part of workflow",
          "title": "template/directory to execute",
          "type": "string"
        }
      },
      "type": "object"
    }
  },
  "$id": "https://nuclei.projectdiscovery.io/template",
  "$ref": "#/$defs/Template",
  "$schema": "https://json-schema.org/draft/2020-12/schema"
}