id: fuzz-header-ssrf

info:
  name: Fuzz Proxy headers
  author: pdteam
  severity: info
  description: Fuzzing Proxy headers for Potential SSRF

# TBD method and path here should be replaced/removed since we get entire http request from file
http:
  - method: POST
    path:
      - "{{BaseURL}}"

    payloads:
      values:
        - "{{interactsh-url}}"
    
    fuzzing:
      - part: headers
        type: replace
        mode: multiple
        keys:
          - "x-forwarded-for"
          - "x-forwarded-host"
          - "forwarded"
          - "x-real-ip"
          - "x-original-url"
          - "x-rewrite-url"
        fuzz:
          - '{{values}}'

    matchers:
      - type: status
        status: 
          - 200

      - type: word
        part: interactsh_protocol  # Confirms dns interaction
        words:
          - "dns"