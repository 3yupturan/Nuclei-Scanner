id: fuzz-header-ssrf

info:
  name: Fuzz Proxy headers
  author: pdteam
  severity: info
  description: Fuzzing Proxy headers for Potential SSRF while resetting password

http:
  - filter:
      - type: word
        part: all_headers
        words:
          - "x-forwarded-for"
          - "x-forwarded-host"
          - "forwarded"
          - "x-real-ip"
          - "x-original-url"
          - "x-rewrite-url"

      - type: word
        part: path
        words:
          - "reset"

    filter-condition: AND

    payloads:
      values:
        - "{{interactsh-url}}"
    
    fuzzing:
      - part: headers
        type: replace
        mode: multiple
        fuzz:
          - '{{values}}'

    matchers:
      - type: status
        status: 
          - 200

      - type: word
        part: interactsh_protocol  # Confirms dns interaction
        words:
          - "dns"